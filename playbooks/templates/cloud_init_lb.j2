runcmd:
  - touch /etc/sysconfig/.finished
rh_subscription:
{% if rhsm_user is defined %}
  username: {{ rhsm_user }}
  password: {{ rhsm_pass }}
{% elif rhsm_master_key is defined %}
  activation-key: {{ rhsm_master_key }}
  org: {{ rhsm_master_org }}
{% endif %}
  add-pool: [{{ rhsm_broker_pool }}]
{% if rhsm_satellite is defined and rhsm_satellite != "" %}
  server-hostname: {{ rhsm_satellite }}
  rhsm-baseurl: {{ rhsm_satellite }}
{% endif %}
  disable-repo:
    - rhel-7-server-rt-rpms
    - rhel-7-server-nfv-rpms
    - rhel-7-server-aus-rpms
    - rhel-7-server-rt-rpms
    - rhel-7-server-tus-rpms
    - rhel-7-server-htb-rpms
  enable-repo:
{% if rhsm_repos is defined %}
{% for repo in rhsm_repos %}
    - {{ repo }}
{% endfor %}
{% else %}
    - rhel-7-server-rpms
    - rhel-7-server-exras-rpms
{% endif %}
packages:
{% if pkgs is defined %}
{% for pkg in pkgs %}
  - {{ pkg }} 
{% endfor %}
{% endif %}
  - ipa-client
  - wget
  - git
  - net-tools
  - bind-utils
  - iptables-services
  - bridge-utils
  - bash-completion
  - kexec-tools
  - sos
  - psacct
  - vim
package_update: true
package_upgrade: false
package_reboot_if_required: false
